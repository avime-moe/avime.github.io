<div id="modals" x-data="{ modal: false }">
  <div class="modal-wrapper" id="gallery-modal" :class="{ 'active': (modal === 'gallery') }" x-on:modal-gallery.window="(modal = 'gallery')">
    <div class="backdrop backdrop-shaded scroll-unlock" x-show.transition.opacity.duration.600ms="modal" x-on:click="modal = false"></div>

    <div class="p-3 rounded modal-panel" :class="{ 'active': (modal === 'gallery') }">
      <div class="relative p-6 overflow-hidden text-center text-white bg-blue-500 border border-black rounded-lg shadow-inset-blue-box">
        <p class="mb-4 text-2xl tracking-wider text-yellow-400 lowercase lg:mb-6 lg:text-3xl text-shadow-heading-darker font-heading">Trait Card Gallery</p>

        <div class="relative mx-auto mb-8" id="gallery">
          <div class="sm:hidden">
            <label for="gallery-select" class="sr-only">Select a type</label>
            <select class="block w-full text-white uppercase bg-blue-500 border border-black rounded shadow-inset-blue-100" id="gallery-select" name="tabs" x-model="$store.myAvime.tabs.gallery">
              <template x-for="trait in ['background', 'body', 'face', 'clothes', 'hair', 'accessory']">
                <option x-text="trait" x-bind:value="trait"></option>
              </template>
            </select>
          </div>

          <nav class="relative hidden overflow-hidden border-t border-l border-r border-blue-100 rounded-t sm:flex shadow-black" id="gallery-tabs" aria-label="Inventory Tabs">
            <template x-for="trait in ['background', 'body', 'face', 'clothes', 'hair', 'accessory']">
              <label class="flex items-center justify-center flex-1 px-5 py-2 text-base font-medium uppercase bg-blue-500 border-l border-r hover:bg-blue-400 border-r-blue-100 border-l-blue-900" :class="{ 'bg-blue-600 hover:bg-blue-600': $store.myAvime.tabs.gallery === trait }" x-on:click="$store.myAvime.tabs.gallery = trait" x-text="trait"></label>
            </template>
          </nav>

          <template x-for="trait in ['background', 'body', 'face', 'clothes', 'hair', 'accessory']">
            <div class="overflow-x-visible overflow-y-scroll bg-blue-600 border border-black rounded-b tab-panel" x-show.transition.in.opacity.duration.600="$store.myAvime.tabs.gallery === trait">
              <div class="max-h-[63.028412vh]">
                <ul class="grid grid-cols-1 gap-2 p-1 mx-auto mb-1 sm:grid-cols-2 lg:mb-2 lg:p-2 xl:grid-cols-3 w-max" x-data="{ cards: [] }" x-init="fetch(`/data/${trait}.json`).then(response => response.json()).then(data => cards = data)">
                  <template x-for="item in cards">
                    <li class="relative z-10 text-sm leading-tight text-left w-max">
                      <span class="relative overflow-hidden block w-[362px] h-[361px] rounded-[11px]">
                        <img class="absolute inset-0 object-cover w-full h-full" alt="" draggable="false" x-bind:src="item.card">
                        <img class="absolute top-[20px] right-[21px] block w-[43px] h-[43px]" alt="" draggable="false" x-bind:src="item.thumb">
                        <img class="absolute top-[76px] block w-[160px] h-[160px]" alt="" draggable="false" :class="{ 'left-[101px]': (trait === 'background'), 'left-[21px]': (trait !== 'background') }" x-bind:src="item.female">
                        <img class="absolute top-[76px] right-[21px] block w-[160px] h-[160px]" alt="" draggable="false" x-bind:src="item.male" x-show="(trait !== 'background')">
                        <span class="absolute top-[20px] left-[21px] flex items-center w-[265px] h-[43px] px-2 py-3 normal-case leading-none text-sm text-black" x-text="item.name"></span>
                        <span class="absolute bottom-[48px] left-[21px] flex items-start w-[320px] h-[64px] p-2 normal-case text-sm text-black" x-text="item.desc"></span>
                        <span class="absolute bottom-[7px] right-[36px] block w-[63px] text-center text-[0.7rem] text-blue-500 uppercase" x-text="(`ID: ${item.ID}`)"></span>
                      </span>
                    </li>
                  </template>
                </ul>
              </div>
            </div>
          </template>
        </div>

        <button class="inline-flex items-center justify-center px-5 py-2 text-base font-medium text-white uppercase bg-red-500 border border-black rounded hover:bg-red-600 shadow-inset-white scroll-unlock" x-on:click="modal = false">Close</button>
      </div>
    </div>
  </div>

  <div class="modal-wrapper" id="fuse-modal" :class="{ 'active': (modal === 'fuse') }" x-on:modal-fuse.window="(modal = 'fuse')">
    <div class="backdrop backdrop-shaded scroll-unlock" x-show.transition.opacity.duration.600ms="modal" x-on:click="window.location.reload()"></div>

    <div class="p-3 rounded modal-panel" :class="{ 'active': (modal === 'fuse') }">
      <div class="relative p-6 overflow-hidden text-center text-white bg-blue-500 border border-black rounded-lg shadow-inset-blue-box">
        <p class="mb-4 text-2xl tracking-wider text-yellow-400 lowercase lg:text-3xl text-shadow-heading-darker font-heading">Avime get!</p>

        <div class="p-2 mb-4 overflow-hidden bg-blue-500 border border-black rounded-lg shadow-inset-blue-box" id="fusion-complete">
          <div class="relative gap-4 p-3 mx-auto overflow-hidden text-black bg-teal-300 border-2 border-blue-600 rounded-lg w-max">
            <div class="mx-auto overflow-hidden border-2 border-black rounded-md w-max">
              <div class="relative w-[160px] h-[160px] bg-gray-500 lg:w-[320px] lg:h-[320px] rounded">
                <img
                  class="absolute inset-0 block w-[160px] h-[160px] max-w-none max-h-none lg:w-[320px] lg:h-[320px] rounded"
                  x-bind:src="('/images/avime/' + $store.myAvime.selected.sex + '.png')"
                  alt=""
                  draggable="false"
                >

                <template x-for="trait in ['background', 'body', 'face', 'clothes', 'hair', 'accessory']">
                  <img class="absolute inset-0 block w-[160px] h-[160px] max-w-none max-h-none lg:w-[320px] lg:h-[320px] rounded-sm" x-bind:src="$store.myAvime.selected.traits[trait][$store.myAvime.selected.sex]" alt="" onerror="(this.src = 'data:image/gif;base64,R0lGODlhAQABAAAAACwAAAAAAQABAAA=')" draggable="false">
                </template>
              </div>
            </div>
          </div>
        </div>

        <p class="mb-4">Your new Avime has been fused!</p>

        <button class="inline-flex items-center justify-center px-5 py-2 text-base font-medium text-white uppercase bg-red-500 border border-black rounded hover:bg-red-600 shadow-inset-white scroll-unlock" x-on:click="window.location.reload()">Close</button>
      </div>
    </div>
  </div>

  <div class="modal-wrapper" id="mint-modal" :class="{ 'active': (modal === 'mint') }" x-on:modal-mint.window="(modal = 'mint')">
    <div class="backdrop backdrop-shaded scroll-unlock" x-show.transition.opacity.duration.600ms="modal" x-on:click="modal = false; $store.myAvime.update()"></div>

    <div class="p-3 rounded modal-panel" :class="{ 'active': (modal === 'mint') }">
      <div class="relative p-6 overflow-hidden text-center text-white bg-blue-500 border border-black rounded-lg shadow-inset-blue-box">
        <p class="mb-4 text-2xl tracking-wider text-yellow-400 lowercase lg:text-3xl text-shadow-heading-darker font-heading">Trait Cards get!</p>

        <p class="mb-4">Your Trait Cards have been minted! Check your wardrobe to see what you got.</p>

        <button class="inline-flex items-center justify-center px-5 py-2 text-base font-medium text-white uppercase bg-red-500 border border-black rounded hover:bg-red-600 shadow-inset-white scroll-unlock" x-on:click="modal = false; $store.myAvime.update()">Close</button>
      </div>
    </div>
  </div>

  <div class="modal-wrapper" id="fused-modal" :class="{ 'active': (modal === 'fused') }" x-on:modal-fused.window="(modal = 'fused')">
    <div class="backdrop backdrop-shaded scroll-unlock" x-show.transition.opacity.duration.600ms="modal" x-on:click="modal = false"></div>

    <div class="p-3 rounded modal-panel w-screen max-w-[1058px]" :class="{ 'active': (modal === 'fused') }">
      <div class="relative p-6 overflow-hidden text-center text-white bg-blue-500 border border-black rounded-lg shadow-inset-blue-box">
        <p class="text-2xl tracking-wider text-yellow-400 lowercase lg:text-3xl text-shadow-heading-darker font-heading">Your fused Avime</p>
        <hr class="my-4 border-t border-b lg:my-8 border-b-blue-200 border-t-blue-900">
        <p class="mb-8" x-text="$store.myAvime.loading.fusions ? 'Loading...' : 'No fused Avime found!'" x-show="!$store.myAvime.loaded.fusions"></p>

        <div class="grid grid-cols-2 gap-4 mb-8 text-sm sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5" x-show="$store.myAvime.mintData.fused && $store.myAvime.mintData.fused.length > 0">
          <template x-for="avime in $store.myAvime.mintData.fused">
            <div class="p-2 uppercase border border-blue-900 rounded-md shadow-inset-blue-200">
              <span class="flex items-center justify-between mb-2 leading-none">
                <span x-text="(`ID: ${avime.ID}`)"></span>
                <span x-text="(avime.unique === true ? 'Original' : `Dupe: ${avime.unique}`)"></span>
              </span>
              <span class="block mx-auto overflow-hidden border-2 border-black rounded w-max">
                <span class="relative block overflow-hidden rounded-sm h-[160px] w-[160px]">
                  <img class="absolute w-full h-full" alt draggable="false" x-bind:src="avime.traits[0]">
                  <img class="absolute w-full h-full" alt draggable="false" x-bind:src="avime.traits[1]">
                  <img class="absolute w-full h-full" alt draggable="false" x-bind:src="avime.traits[2]">
                  <img class="absolute w-full h-full" alt draggable="false" x-bind:src="avime.traits[3]">
                  <img class="absolute w-full h-full" alt draggable="false" x-bind:src="avime.traits[4]">
                  <img class="absolute w-full h-full" alt draggable="false" x-bind:src="avime.traits[5]">
                </span>
              </span>
            </div>
          </template>
        </div>

        <button class="inline-flex items-center justify-center px-5 py-2 text-base font-medium text-white uppercase bg-red-500 border border-black rounded hover:bg-red-600 shadow-inset-white scroll-unlock" x-on:click="modal = false">Close</button>
      </div>
    </div>
  </div>

  <div class="modal-wrapper" id="error-modal" :class="{ 'active': (modal === 'error') }" x-on:modal-error.window="(modal = 'error')">
    <div class="backdrop backdrop-shaded scroll-unlock" x-show.transition.opacity.duration.600ms="modal" x-on:click="modal = false"></div>

    <div class="p-3 rounded modal-panel" :class="{ 'active': (modal === 'error') }">
      <div class="relative p-6 overflow-hidden text-center text-white bg-blue-500 border border-black rounded-lg shadow-inset-blue-box">
        <p class="text-2xl tracking-wider text-yellow-400 lowercase lg:text-3xl text-shadow-heading-darker font-heading">Error loading data</p>
        <hr class="my-4 border-t border-b lg:my-8 border-b-blue-200 border-t-blue-900">
        <p class="mb-4">Please refresh your browser window and try again.</p>

        <button class="inline-flex items-center justify-center px-5 py-2 text-base font-medium text-white uppercase bg-blue-500 border border-black rounded hover:bg-blue-400 shadow-inset-white scroll-unlock" x-on:click="window.location.reload()">Refresh</button>
      </div>
    </div>
  </div>
</div>
